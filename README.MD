# Подготовка изображений
- Подготовка загруженных или существующих изображений
- Корректировка размера для вписывания в определенные размеры
- Создание миниатюры и вписывание в определенные размеры
- Добавление водного знака в центр или справа снизу
- Массовые операции с изображениями
- Корректировка выделяемой ОЗУ во время работы
- Корректировка времени обработки
- Указание качества конечных Jpeg изображений
- Использование GD2

## Установка 

### Composer

```bash
composer require OlegMordvintsev/ImagePrepare
```

### Native

Используйте в example/index.php
```php
require_once __DIR__. '/../src/ImagePrepare.php';
```
вместо 
```php
require_once __DIR__ . '/vendor/autoload.php';
```

## Значения по умолчанию
```php
$image = new Image(
    1000, // ширина (по умолчанию 1920, укажите null, если нужно значение по умолчанию)
    750,  // высота (по умолчанию 1920, укажите null, если нужно значение по умолчанию)
    120,  // ширина миниатюры (по умолчанию 320, укажите null, если нужно значение по умолчанию)
    120,  // высота миниатюры (по умолчанию 320, укажите null, если нужно значение по умолчанию)
    'watermark.png', // файл водного знака (по умолчанию false, укажите null, если нужно значение по умолчанию)
    1, // водный знак в центре (по умолчанию 0, укажите null, если нужно значение по умолчанию)
    512, // 512Mb выделить в ОЗУ (по умолчанию false, укажите null, если нужно значение по умолчанию)
    60, // 60 сек. на одно изображение (по умолчанию false, укажите null, если нужно значение по умолчанию)
    85 // качество готового jpg изображения (по умолчанию 80, укажите null, если нужно значение по умолчанию)
);
```

## Примеры

### Перед использованием необходимо
- В начале файла подключить пространство имен
```php
use OlegMordvintsev\ImagePrepare\Image;
```
- Убедиться, что модуль "OlegMordvintsev/ImagePrepare" подключен, смотрите выше "require_once" 

### 1. Простое использование ###
```php
$image = new Image();
$image->process('in.jpg', 'out.jpg');
```

### 2. Изменение ширины и высоты ###
```php
$image = new Image(
    2000, // ширина
    1500 // высота
);
$image->process('in.jpg', 'out.jpg');
```

### 3. Добавление миниатюры без изменения размеров по умолчанию основного изображения ###
```php
$image = new Image(
    null, // ширина по умолчанию
    null, // высота по умолчанию
    320, // ширина миниатюры
    240 // высота миниатюры
);
$image->process('in.jpg', 'out.jpg', 'out_thumbs.jpg');
```

### 4. Миниатюра и водный знак справа снизу ###
```php
$image = new Image(
    1500, // ширина
    1500, // высота
    null, // ширина миниатюры по умолчанию
    null, // высота миниатюры по умолчанию
    'watermark.png', // файл водного знака
    1 // водный знак справа снизу
);
$image->process('in.jpg', 'out.jpg', 'out_thumbs.jpg');
```

### 5. Все параметры меняем ###
```php
$image = new Image(
    2000, // ширина
    2000,  // высота
    300,  // ширина миниатюры
    300,  // высота миниатюры
    'watermark.png', // файл водного знака
    0, // водный знак в центре
    512, // 512Mb выделить в ОЗУ
    90, // 90 секунд на выполнение операции с одним изображением
    80 // качество готового jpg изображения
);
$image->process('in.jpg', 'out.jpg', 'out_thumbs.jpg');
```

### 6. Массовая обработка из директории с сохранением названия файла ###
```php
$inDir = __DIR__ . '/inDir/';
$outDir = __DIR__ . '/outDir/';

$image = new Image(
    1000, // ширина
    1000,  // высота
    120,  // ширина миниатюры
    120,  // высота миниатюры
    'watermark.png', // файл водного знака
    0, // водный знак в центре
    512, // 512Mb выделить в ОЗУ
    30, // 30 секунд на выполнение операции с одним изображением
    85 // качество готового jpg изображения
);

if ($handle = opendir($inDir)) {

    while (false !== ($entry = readdir($handle))) {

        if ($entry != "." && $entry != "..") {

            // Получаем имя файла без расширения
            $out = explode(".", $entry);
            array_pop($out);
            $out = implode(".", $out);

            // Обработка изображения
            echo $image->process(
                $inDir . $entry, // изображение в обработку
                $outDir . $out . '.jpg', // готовое изображение
                $outDir . $out . '_thumbs.jpg' // готовая миниатюра
            );

            if (php_sapi_name() === 'cli')
                echo ' Файл: ' . $inDir . $entry . "\n";
            else
                echo ' Файл: ' . $inDir . $entry . "<br>";

        }

    }

    closedir($handle);

}
```
